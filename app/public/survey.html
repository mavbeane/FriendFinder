<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Friend Finder</title>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
		<link rel="stylesheet" href="/assets/css/styles.css">
		<script src="https://code.jquery.com/jquery-3.1.0.js" integrity="sha256-slogkvB1K3VOkzAI8QITxV3VzpOnkeNVsKvtkYLMjfk=" crossorigin="anonymous"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
		<style type="text/css">
			label, footer {
				margin-top: 20px;
			}
			button {
				margin-top: 40px;
			}
		</style>
	</head>
	<body>
		<div class="container">

			<div class="row">
			  <div class="col-xs-12 col-md-12">
			  	<h2>Survey Questions</h2>
				<div id="survey">
					<div class="bkg-clr">
							<label for="name">Name</label>
							<input required type="text" class="form-control" id="name" placeholder="Name">

							<label for="email">Email</label>
							<input required type="email" class="form-control" id="email" placeholder="Email">

							<label for="photoLink">Link to photo</label>
							<input required type="text" class="form-control" id="photoLink" placeholder="Photo">
					</div>
					<form class="form-group">
						<label>Question 1</label>
						<p>I enjoy meeting new people.</p>
						<select class="form-control" id="qu1">
						  <option selected disabled>Make selection</option>
						  <option value="1">1 (Strongly Disagree)</option>
						  <option value="2">2</option>
						  <option value="3">3</option>
						  <option value="4">4</option>
						  <option value="5">5 (Strongly Agree)</option>
						</select>
						<label>Question 2</label>
						<p>I like helping people.</p>
						<select class="form-control"  id="qu2">
						  <option selected disabled>Make selection</option>
						  <option value="1">1 (Strongly Disagree)</option>
						  <option value="2">2</option>
						  <option value="3">3</option>
						  <option value="4">4</option>
						  <option value="5">5 (Strongly Agree)</option>
						</select>						
						<label>Question 3</label>
						<p>I like to understand the underlying theory.</p>
						<select class="form-control" id="qu3">
						 	<option selected disabled>Make selection</option>
						  <option value="1">1 (Strongly Disagree)</option>
						  <option value="2">2</option>
						  <option value="3">3</option>
						  <option value="4">4</option>
						  <option value="5">5 (Strongly Agree)</option>
						</select>
						<label>Question 4</label>
						<p>I am modest about what I have achieved.</p>
						<select class="form-control" id="qu4">
						  <option selected disabled>Make selection</option>
						  <option value="1">1 (Strongly Disagree)</option>
						  <option value="2">2</option>
						  <option value="3">3</option>
						  <option value="4">4</option>
						  <option value="5">5 (Strongly Agree)</option>
						</select>
						<label>Question 5</label>
						<p>I usually feel relaxed.</p>
						<select class="form-control" id="qu5">
						  <option selected disabled>Make selection</option>
						  <option value="1">1 (Strongly Disagree)</option>
						  <option value="2">2</option>
						  <option value="3">3</option>
						  <option value="4">4</option>
						  <option value="5">5 (Strongly Agree)</option>
						</select>
						<label>Question 6</label>
						<p>I sometimes make mistakes.</p>
						<select class="form-control" id="qu6">
						  <option selected disabled>Make selection</option>
						  <option value="1">1 (Strongly Disagree)</option>
						  <option value="2">2</option>
						  <option value="3">3</option>
						  <option value="4">4</option>
						  <option value="5">5 (Strongly Agree)</option>
						</select>
						<label>Question 7</label>
						<p>I like to try out new activities.</p>
						<select class="form-control" id="qu7">
						  <option selected disabled>Make selection</option>
						  <option value="1">1 (Strongly Disagree)</option>
						  <option value="2">2</option>
						  <option value="3">3</option>
						  <option value="4">4</option>
						  <option value="5">5 (Strongly Agree)</option>
						</select>
						<label>Question 8</label>
						<p>	I consider other peopleâ€™s feelings.</p>
						<select class="form-control" id="qu8">
						  <option selected disabled>Make selection</option>
						  <option value="1">1 (Strongly Disagree)</option>
						  <option value="2">2</option>
						  <option value="3">3</option>
						  <option value="4">4</option>
						  <option value="5">5 (Strongly Agree)</option>
						</select>
						<label>Question 9</label>
						<p>I am prepared to tell people if they are mistaken.</p>
						<select class="form-control" id="qu9">
						  <option selected disabled>Make selection</option>
						  <option value="1">1 (Strongly Disagree)</option>
						  <option value="2">2</option>
						  <option value="3">3</option>
						  <option value="4">4</option>
						  <option value="5">5 (Strongly Agree)</option>
						</select>
						<label>Question 10</label>
						<p>I rely more on my feelings than on analysis of the situatio</p>
						<select class="form-control" id="qu10">
						  <option selected disabled>Make selection</option>
						  <option value="1">1 (Strongly Disagree)</option>
						  <option value="2">2</option>
						  <option value="3">3</option>
						  <option value="4">4</option>
						  <option value="5">5 (Strongly Agree)</option>
						</select>
						
						
						<button type="submit" id="submit" class="btn btn-primary btn-lg btn-block">Submit</button>
					</form>
				</div>
			  </div>
			</div>
			
		</div>

		<!-- Modal -->
		<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
		  <div class="modal-dialog" role="document">
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		        <h4 class="modal-title" id="myModalLabel">YOUR NEW FRIEND</h4>
		      </div>
		      <div class="modal-body">
		        ...
		      </div>
		      <div class="modal-footer">
		        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		      </div>
		    </div>
		  </div>
		</div>

		<footer  style="text-align: center">
			<a href="/api/friends">Friends</a>
		</footer>
<script>
	$('#submit').on('click', function(){

		var newFriend = {
			friendName: $('#name').val().trim(),
			friendEmail: $('#email').val().trim(),
			friendPhoto: $('#photoLink').val().trim(),
			scores: []				
		};
		
		for (var i = 1; i <= 10; i++) {
			var questionValue = $('#qu' + [i]).val();
			if (questionValue == null) {
				newFriend.scores.push('0');
			} else {
				newFriend.scores.push(questionValue);
			};
		};

		var currentURL = window.location.origin;

		$.ajax({url: currentURL + "/api/friends", method: "GET"})
	            .done(function(friendsData) {
				
			var lowScoreIndex = 0;
			var lowScore = 100;
			for (var i = 1; i < friendsData.length - 1; i++) {
				var addedScore = 0;
				for (var scoreQ = 0; scoreQ < 10; scoreQ++) {
					addedScore = Math.abs((newFriend.scores[scoreQ] - friendsData[i].scores[scoreQ])) + addedScore;
				};

				if (addedScore < lowScore) {
					lowScore = addedScore;
					lowScoreIndex = i;
				};		
			};
			$('.modal-body').html('<p>Name: ' + friendsData[lowScoreIndex].friendName +
				'</p><p>Email: ' + friendsData[lowScoreIndex].friendEmail + '</p><p><img src="' + friendsData[lowScoreIndex].friendPhoto + '" width="400px" height="auto"></p>');
			$('#myModal').modal();
		});

		$.post(currentURL + '/api/friends', newFriend, function(data) {
			$('#name').val('')
			$('#email').val('')
			$('#photoLink').val('')
			for (var i = 1; i <= 10; i++) {
				$('#qu' + [i]).val('');
			};
		});
		return false;
	});
</script>

	</body>
</html>